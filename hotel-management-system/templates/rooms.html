{% extends "base.html" %}
{% block title %}اتاق‌ها{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <div>
    <h3 class="fw-bold mb-1">اتاق‌ها</h3>
    <div class="text-muted">مدیریت اتاق‌ها و وضعیت</div>
  </div>
  <div class="d-flex gap-2">
    <a class="btn btn-success" href="{{ url_for('add_room') }}">
      <i class="bi bi-door-open ms-1"></i> افزودن اتاق
    </a>
  </div>
</div>

<div class="card app-card">
  <div class="card-body">
    <div class="row g-2 mb-3">
      <div class="col-12 col-md-6">
        <div class="input-group">
          <span class="input-group-text"><i class="bi bi-search"></i></span>
          <input class="form-control" id="tableSearch" placeholder="جستجو در اتاق‌ها...">
        </div>
      </div>
    </div>

    {% if rooms %}
    <div class="table-responsive">
      <table class="table table-hover align-middle" id="dataTable">
        <thead class="table-light">
          <tr>
            <th>کد</th>
            <th>نوع</th>
            <th>ظرفیت</th>
            <th>قیمت</th>
            <th>طبقه</th>
            <th>تخت</th>
            <th>سیگار</th>
            <th>وضعیت</th>
            <th class="text-end">عملیات</th>
          </tr>
        </thead>
        <tbody>
          {% for r in rooms %}
          <tr>
            <td class="persian-digits fw-semibold">{{ r.room_id }}</td>
            <td>{{ r.type }}</td>
            <td class="persian-digits">{{ r.capacity }}</td>
            <td class="persian-digits">{{ r.price }}</td>
            <td class="persian-digits">{{ r.floor }}</td>
            <td>{{ r.bed_type }}</td>
            <td>{% if r.smoking %}بله{% else %}خیر{% endif %}</td>
            <td>
              <span class="badge rounded-pill
                {% if r.status=='available' %}text-bg-success
                {% elif r.status=='reserved' %}text-bg-warning
                {% elif r.status=='occupied' %}text-bg-danger
                {% else %}text-bg-secondary{% endif %}">
                {{ r.status }}
              </span>
            </td>
            <td class="text-end">
              <form class="d-inline" method="POST" action="{{ url_for('update_room_status', room_id=r.room_id) }}">
                <div class="input-group input-group-sm">
                  <select class="form-select" name="status">
                    <option value="available" {% if r.status=='available' %}selected{% endif %}>available</option>
                    <option value="reserved" {% if r.status=='reserved' %}selected{% endif %}>reserved</option>
                    <option value="occupied" {% if r.status=='occupied' %}selected{% endif %}>occupied</option>
                    <option value="cleaning" {% if r.status=='cleaning' %}selected{% endif %}>cleaning</option>
                  </select>
                  <button class="btn btn-outline-primary" title="ذخیره"><i class="bi bi-check2"></i></button>
                </div>
              </form>
              <a class="btn btn-sm btn-outline-danger confirm-delete ms-1" href="{{ url_for('delete_room', room_id=r.room_id) }}">
                <i class="bi bi-trash"></i>
              </a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
      <div class="empty-state">
        <div class="empty-icon"><i class="bi bi-door-closed"></i></div>
        <div class="fw-bold">هیچ اتاقی ثبت نشده</div>
        <div class="text-muted">اولین اتاق را اضافه کن.</div>
        <a class="btn btn-success mt-2" href="{{ url_for('add_room') }}">افزودن اتاق</a>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
